INSERT
INTO
    prod_stnd_crcog_tbls.MSI_AGMT_PREM
    (
        AGMT_ID,
        MSI_AGMT_PREM_ID,
        CARR_ADMIN_SYS_CD,
        HLDG_KEY_PFX,
        HLDG_KEY,
        HLDG_KEY_SFX,
        SRC_CARR_ADMIN_SYS_CD,
        SRC_POL_NUM,
        SRC_POL_NUM_SFX,
        PROD_ID,
        SRC_PROD_ID,
        SRC_PROD_DESC,
        SRC_ADMIN_PROD_CD,
        AGY_PRTY_ID,
        AGY_BPID,
        AGY_ID,
        AGT_PRTY_ID,
        AGT_BPID,
        ADMIN_TRANSACTION_DT,
        ACCT_POOL_CD,
        SRC_PD_DT,
        SRC_AGT_ID,
        SRC_AGT_SSN,
        ADJ_IND,
        SRC_AGT_FULL_NM,
        SRC_AGT_EMPE_NR,
        SRC_CNTRCT_NM,
        SRC_AGT_APPT_DT,
        SRC_AGT_TRM_DT,
        SRC_ENT_LOB_CD,
        FY_RNWL_PREM_CD,
        SRC_TRAN_TYP_CD,
        SRC_TRAN_DESC,
        FY_PREM_AMT,
        RY_PREM_AMT,
        INSD_FULL_NM,
        PYMT_MTHD_CD,
        SRC_POL_PY_MODE_CD,
        CR_WK_STRT_DT,
        RVRSL_IND,
        SRC_RVRSL_IND,
        SRC_SYS_ID,
        RUN_ID,
        UPDT_RUN_ID,
        TRANS_DT,
        LOB_CDE,
        PREM_TXN_ID
    )
    select S.AGMT_ID,
S. MSI_AGMT_PREM_ID,
S.CARR_ADMIN_SYS_CD,
S.HLDG_KEY_PFX,
S.HLDG_KEY,
S.HLDG_KEY_SFX,
S.SRC_CARR_ADMIN_SYS_CD,
S.SRC_POL_NUM,
S.SRC_POL_NUM_SFX,
S.PROD_ID,
S.SRC_PROD_ID,
S.SRC_PROD_DESC,
S.SRC_ADMIN_PROD_CD,
S.AGY_PRTY_ID,
S.AGY_BPID,
S.AGY_ID,
S.AGT_PRTY_ID,
S.AGT_BPID,
S.ADMIN_TRANSACTION_DT,
S.ACCT_POOL_CD,
S.SRC_PD_DT,
S.SRC_AGT_ID,
S.SRC_AGT_SSN,
S.ADJ_IND,
S.SRC_AGT_FULL_NM,
S.SRC_AGT_EMPE_NR,
S.SRC_CNTRCT_NM,
S.SRC_AGT_APPT_DT,
S.SRC_AGT_TRM_DT,
S.SRC_ENT_LOB_CD,
S.FY_RNWL_PREM_CD,
S.SRC_TRAN_TYP_CD,
S.SRC_TRAN_DESC,
S.FY_PREM_AMT,
S.RY_PREM_AMT,
S.INSD_FULL_NM,
S.PYMT_MTHD_CD,
S.SRC_POL_PY_MODE_CD,
S.CR_WK_STRT_DT,
S.RVRSL_IND,
S.SRC_RVRSL_IND,
S.SRC_SYS_ID,
S.RUN_ID,
S.UPDT_RUN_ID,
S.TRANS_DT,
S.LOB_CDE,
S.PREM_TXN_ID from squark_staging.MSI_AGMT_PREM_VW S left join prod_stnd_crcog_tbls.MSI_AGMT_PREM M on S.MSI_AGMT_PREM_ID = M.MSI_AGMT_PREM_ID where M.MSI_AGMT_PREM_ID is null ;
;

commit ;

